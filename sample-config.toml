# sample-config.toml
#
# This file is a **template** showing all available options and their factory
# defaults. Copy it to `config.toml` and tweak values to customize behavior.
#
# NOTE: This file is NOT read by the program; only `config.toml` is.

# Camera index to open. Usually 0 is the internal / primary camera.
# Older key `camera_device` is still accepted; `camera_index` is preferred.
camera_index = 0

# Capture resolution used for luma calculation (width, height).
# Higher resolution = more detail but more CPU.
camera_resolution = [
    640,  # width in pixels
    400,  # height in pixels
]

# Number of frames to discard while the camera auto-exposure/white-balance settles.
camera_warmup_frames = 30

# Smoothing factor for ambient luma (0.0–1.0).
#  - Lower values (e.g. 0.05) react slowly but are very stable.
#  - Higher values (e.g. 0.5) react quickly but may flicker.
ambient_smoothing_strength = 0.15

# Logical brightness range for your display backlight.
# `screen_brightness_min` and `screen_brightness_max` are the values written to
# /sys/class/backlight/.../brightness when ambient is darkest/brightest.
screen_brightness_min = 1
screen_brightness_max = 937

# How often to capture a new frame from the camera (in milliseconds).
capture_interval_ms = 500

# How often to step the backlight towards the current target (in milliseconds).
brightness_step_interval_ms = 50

# Controls how aggressively we move towards the new brightness target.
# The actual step size is roughly |target-current| / brightness_step_divisor,
# clamped between 1 and brightness_step_max.
brightness_step_divisor = 20

# Maximum step size per smooth interval.
# Lower = smoother but slower; higher = faster but may cause jumps.
brightness_step_max = 60

# Optional camera calibration range for normalized luma.
# When set, the raw camera luma is mapped from [ambient_luma_min, ambient_luma_max]
# into [0.0, 1.0]. Values outside this range are clamped.
# These defaults give a reasonable starting point for many indoor setups.
ambient_luma_min = 0.05
ambient_luma_max = 0.8

# Whether this config is considered calibrated.
# Normally set to true after running `--calibrate` once.
calibrated = true

# Logging verbosity:
#   "off"     – disable all file logging
#   "minimal" – only critical warnings/errors
#   "low"     – basic status + important info
#   "medium"  – more detailed info
#   "high"    – very chatty
#   "verbose" – maximum detail
logging = "low" # off|minimal|low|medium|high|verbose

# Optional custom logs directory. If omitted, logs go to
#   ~/.cache/SMART_BRIGHTNESS/logs
# You can use "~/..." here as well.
# Older key `logging_path` is still accepted; `log_directory` is preferred.
# log_directory = "~/.cache/SMART_BRIGHTNESS/logs"

# === Circadian (time-of-day) behavior ===

# Master switch for circadian adjustment.
#  - true  = brighten during day, soften at night
#  - false = brightness depends only on ambient luma
circadian_enabled = true

# Multipliers applied to normalized ambient luma during day and night.
# Values > 1.0 brighten, values < 1.0 dim.
circadian_day_boost = 1.05
circadian_night_dim = 0.95

# Local clock hours (0–23) defining day/night boundaries.
# Example below: day = [06:00, 18:00], night = everything else.
circadian_day_start_hour = 6
circadian_night_start_hour = 18

# === Status and error reporting ===

# How often (in seconds) status lines like
#   "→ Target brightness 900 (normalized 0.950)"
# may be printed/logged at most **when changes are small**.
# This is the "base" interval used for subtle brightness changes.
status_interval_seconds = 5

# Minimum change in brightness value before a new status line is considered
# a "real" change worth logging (in backlight units).
status_min_brightness_change = 8

# When brightness jumps by at least this amount, a faster status interval is
# used so you see changes more quickly.
status_fast_change_threshold = 40

# Fast status-logging interval (seconds) used when the brightness change is
# at least `status_fast_change_threshold`. This lets you log more frequently
# during steep transitions while keeping logs quieter when things are stable.
status_fast_interval_seconds = 1

# Throttle interval (in seconds) for repeated error messages (e.g. camera errors).
# Identical errors closer than this interval are suppressed.
error_throttle_seconds = 2

# === Ambient-change sensitivity ===

# Minimum change in adjusted normalized luma (0.0–1.0) required to update
# the brightness target. Very small fluctuations below this threshold are
# ignored to avoid micro-adjustments.
# Example: 0.01 ≈ 1% change.
ambient_luma_min_change = 0.01

# === Target brightness logging ===

# Whether lines showing the chosen target brightness should be emitted at all.
#  - true  = status lines are allowed (still subject to thresholds and interval)
#  - false = suppress target brightness lines entirely
status_show_target_brightness = true

# Whether status lines should be logged **only** when the brightness has
# actually changed. When true, no periodic "heartbeat" logs are emitted; you
# only see updates when the target brightness crosses `status_min_brightness_change`.
status_only_when_changed = true
